<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Health Analytics Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h1>üè• Patient Health Analytics Dashboard</h1>
                <div>
                    <a href="/api/epic/login" class="btn btn-primary btn-lg" style="margin-right: 10px;">Login with Epic</a>
                    <a href="/bulk-epic-export" class="btn btn-success btn-lg">üìä Bulk Epic Extraction</a>
                </div>
            </div>
            <div class="status">
                <div class="status-dot"></div>
                <span>API Connected</span>
            </div>
        </header>

<div class="card demo-card">
    <h2>üìã Demo Instructions (Epic Test Server)</h2>
    <div class="instructions-content">
        <ol>
            <li><strong>Login with Epic:</strong> Click the "Login with Epic" button above</li>
            <li><strong>Enter Test Credentials:</strong>
                <div class="credentials">
                    <div><strong>Username:</strong> <code>fhirjunkie</code></div>
                    <div><strong>Password:</strong> <code>FHIRJunkie1!</code></div>
                </div>
            </li>
            <li><strong>Authorize Access:</strong> Click allow on the authorization screen</li>
            <li><strong>View Epic Data:</strong> You'll be redirected to the Epic FHIR dashboard with patient data</li>
            <li><strong>Bulk Extract Data:</strong> Navigate to "üìä Bulk Epic Extraction" to export all patient demographics</li>
            <li><strong>Save Data:</strong> Click "üíæ Save to Database" to store observations locally</li>
            <li><strong>View Results:</strong> Return to home page to see saved observations in the dashboard</li>
        </ol>
    </div>
</div>

        <!-- Dashboard Cards -->
        <div class="dashboard">
            <!-- Patient Count Card -->
            <div class="card">
                <h2>Total Patients</h2>
                <div class="card-description" id="count-desc">Loading...</div>
                <div class="query-info" id="count-query">Running query...</div>
                <div class="data-content">
                    <div class="big-number" id="count-data">-</div>
                </div>
                <div class="timestamp" id="count-time"></div>
            </div>

            <!-- Patient Conditions Analytics Card -->
            <div class="card">
                <h2>Conditions by Patient Count</h2>
                <div class="card-description" id="conditions-desc">Loading...</div>
                <div class="query-info" id="conditions-query">Running query...</div>
                <div class="data-content" id="conditions-data">Loading...</div>
                <div class="timestamp" id="conditions-time"></div>
            </div>
        </div>

        <!-- All Patients Table -->
        <div class="card">
            <h2>All Patients</h2>
            <div class="card-description" id="patients-desc">Loading...</div>
            <div class="query-info" id="patients-query">Running query...</div>
            <div class="data-content" id="patients-data">Loading...</div>
            <div class="timestamp" id="patients-time"></div>
        </div>

        <!-- All Conditions Table -->
        <div class="card">
            <h2>All Conditions</h2>
            <div class="card-description" id="all-conditions-desc">Loading...</div>
            <div class="query-info" id="all-conditions-query">Running query...</div>
            <div class="data-content" id="all-conditions-data">Loading...</div>
            <div class="timestamp" id="all-conditions-time"></div>
        </div>

        <!-- Saved Epic Observations -->
        <div class="card">
            <h2>üìä Saved Epic Observations</h2>
            <div class="card-description" id="epic-obs-desc">Loading...</div>
            <div class="data-content" id="epic-obs-data">Loading...</div>
            <div class="timestamp" id="epic-obs-time"></div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='index.js') }}"></script>
</body>
</html>